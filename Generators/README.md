# Ubicomp.Utils.NET.Generators

This project contains Roslyn Source Generators used to automate boilerplate code within the Ubicomp.Utils.NET solution.

## Purpose
In the `MulticastTransportFramework`, messages are routed based on string IDs defined via the `[MessageType]` attribute. Historically, developers had to manually register each message type with the `TransportComponent`.

This generator automates that process by scanning the compilation for classes decorated with `[MessageType]`, and generating an extension method that registers them all at once.

## How it Works
1.  **Scan**: The generator looks for class declarations with the `MessageTypeAttribute`.
2.  **Extract**: It extracts the message ID string from the attribute constructor.
3.  **Generate**: It produces a class `Ubicomp.Utils.NET.Generators.AutoDiscovery.TransportExtensions` containing the `RegisterDiscoveredMessages` method.

## Generated Code Example

```csharp
// <auto-generated/>
using System;
using Ubicomp.Utils.NET.MulticastTransportFramework;

namespace Ubicomp.Utils.NET.Generators.AutoDiscovery
{
    public static class TransportExtensions
    {
        /// <summary>
        /// Registers all message types discovered by Source Generator.
        /// </summary>
        public static void RegisterDiscoveredMessages(this TransportComponent component)
        {
            component.RegisterMessageType<MyNamespace.MyMessage>("my.message.id");
            // ... other discovered types
        }
    }
}
```

## Usage
The `TransportBuilder` automatically calls `RegisterDiscoveredMessages` via reflection (to avoid hard circular dependencies), ensuring that any message type defined in an assembly using this generator is automatically registered.
